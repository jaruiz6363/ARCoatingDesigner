<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:ARCoatingDesigner.App.ViewModels"
        xmlns:sp="clr-namespace:ScottPlot.Avalonia;assembly=ScottPlot.Avalonia"
        x:Class="ARCoatingDesigner.App.Views.IndexPlotDialog"
        x:DataType="vm:IndexPlotViewModel"
        Title="Index of Refraction vs Wavelength"
        Width="650" Height="550"
        WindowStartupLocation="CenterOwner">

    <DockPanel Margin="8">
        <!-- Top: Controls -->
        <StackPanel DockPanel.Dock="Top" Spacing="6" Margin="0,0,0,6">
            <Grid ColumnDefinitions="Auto,*,Auto,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto" Margin="0,0,0,4">
                <!-- Source Type -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Source:" VerticalAlignment="Center" Margin="0,0,8,4"/>
                <ComboBox Grid.Row="0" Grid.Column="1" SelectedIndex="{Binding SourceTypeIndex}" Margin="0,0,0,4">
                    <ComboBoxItem>Glass Catalog</ComboBoxItem>
                    <ComboBoxItem>Coating Material</ComboBoxItem>
                </ComboBox>

                <!-- Glass catalog selection (visible when Glass source) -->
                <TextBlock Grid.Row="1" Grid.Column="0" Text="Catalog:" VerticalAlignment="Center" Margin="0,0,8,4"
                           IsVisible="{Binding IsGlassSource}"/>
                <ComboBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"
                          ItemsSource="{Binding AvailableCatalogs}"
                          SelectedItem="{Binding SelectedCatalog}"
                          IsVisible="{Binding IsGlassSource}" Margin="0,0,0,4"/>

                <!-- Glass selection -->
                <TextBlock Grid.Row="2" Grid.Column="0" Text="Glass:" VerticalAlignment="Center" Margin="0,0,8,4"
                           IsVisible="{Binding IsGlassSource}"/>
                <ComboBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3"
                          ItemsSource="{Binding AvailableGlasses}"
                          SelectedItem="{Binding SelectedGlass}"
                          IsVisible="{Binding IsGlassSource}" Margin="0,0,0,4"/>

                <!-- Material selection (visible when Coating Material source) -->
                <TextBlock Grid.Row="1" Grid.Column="0" Text="Material:" VerticalAlignment="Center" Margin="0,0,8,4"
                           IsVisible="{Binding IsMaterialSource}"/>
                <ComboBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"
                          ItemsSource="{Binding AvailableMaterials}"
                          SelectedItem="{Binding SelectedMaterial}"
                          IsVisible="{Binding IsMaterialSource}" Margin="0,0,0,4"/>

                <!-- Wavelength range -->
                <TextBlock Grid.Row="3" Grid.Column="0" Text="λ min (μm):" VerticalAlignment="Center" Margin="0,0,8,4"/>
                <NumericUpDown Grid.Row="3" Grid.Column="1" Value="{Binding WavelengthMin}"
                               Minimum="0.1" Maximum="20" Increment="0.01" FormatString="F3" Margin="0,0,8,4"/>
                <TextBlock Grid.Row="3" Grid.Column="2" Text="λ max (μm):" VerticalAlignment="Center" Margin="0,0,8,4"/>
                <NumericUpDown Grid.Row="3" Grid.Column="3" Value="{Binding WavelengthMax}"
                               Minimum="0.1" Maximum="20" Increment="0.01" FormatString="F3" Margin="0,0,0,4"/>

                <TextBlock Grid.Row="4" Grid.Column="0" Text="λ step (μm):" VerticalAlignment="Center" Margin="0,0,8,4"/>
                <NumericUpDown Grid.Row="4" Grid.Column="1" Value="{Binding WavelengthStep}"
                               Minimum="0.001" Maximum="1" Increment="0.001" FormatString="F3" Margin="0,0,8,4"/>
            </Grid>

            <!-- Buttons -->
            <StackPanel Orientation="Horizontal" Spacing="6">
                <Button Content="Calculate" Click="OnCalculateClick" IsDefault="True" Padding="12,4"/>
                <Button Content="Export Text..." Click="OnExportTextClick" Padding="12,4"/>
                <Button Content="Close" Click="OnCloseClick" Padding="12,4"/>
            </StackPanel>
        </StackPanel>

        <!-- Bottom: Status bar -->
        <Border DockPanel.Dock="Bottom" Background="#F0F0F0" Padding="6,3" Margin="0,4,0,0">
            <TextBlock Text="{Binding StatusText}" FontSize="12"/>
        </Border>

        <!-- Center: Chart -->
        <Border BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4">
            <sp:AvaPlot Name="AvaPlot1"/>
        </Border>
    </DockPanel>
</Window>
